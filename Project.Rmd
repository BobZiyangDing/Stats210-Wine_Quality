---
title: "Project"
author: "Bob Ding, Lynn Fan, Alice Jiang"
date: "11/18/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library("cowplot")
library("tibble")
library("dplyr")
library("ggplot2")
library("broom")
library("knitr")
```

# Data Exploration
```{r}
# input data source
data <- read.csv("./redwine_quality.csv")
```

```{r}
# convert quality into factor variable
data <- data %>% mutate(quality = as.factor(quality))
```

```{r}
# overview of the dataset
glimpse(data)
```

```{r}
# scatter plot matrix one
pairs(quality ~ fixed.acidity + volatile.acidity + citric.acid + density + residual.sugar + chlorides, data=data)
``` 

The scatter plot matrix suggests a fairly strong positive linear relationship between fixed.acidity and citric.acid; fixed.acidity and density; and density and residual.sugar. There also appears to be a strong negative linear relationship between volatile.acidity and citric.acid. 

```{r}
# correlation coefficients for potential multicollinearity
cor(data$fixed.acidity, data$citric.acid)
cor(data$fixed.acidity, data$density)
cor(data$volatile.acidity, data$citric.acid)
cor(data$density, data$residual.sugar)
```

The correlation coefficent for fixed.acidity and citric.acid (0.6717034) and the correlation coefficient for fixed.acidity and density (0.6680473) show moderate to strong linear relationship between the variables. To remove potential multicollinearity impact, we **will not include fixed.acidity** in the model.

```{r}
# scatter plot matrix two
pairs(quality ~ free.sulfur.dioxide + total.sulfur.dioxide + pH + sulphates + alcohol, data=data)
```

The scatter plot shows strong positive linear relationship between free.sulfur.dioxide and total.sulfur.dioxide.

```{r}
# correlation coefficients for potential multicollinearity
cor(data$free.sulfur.dioxide, data$total.sulfur.dioxide)
```

The correlation coefficient of 0.6676665 between free.sulfur.dioxide and total.sulfur.dioxide indicates strong positive linear relationship. We also know from the data description that total.sulfur dioxide includes free.sulfur.dioxide - whose concentration level could impact the smell and taste of the wine, thus impacting quality. So it is sufficient to include only one of these two variables in the model, and we **will include free.sulphur.dioxide**.

```{r}
# distribution of each variable
p1  <- ggplot(data = data, aes(x = quality) ) + geom_histogram(stat="count",fill= "lightblue") 
p3  <- ggplot(data = data, aes(x = volatile.acidity) ) + theme(axis.text=element_text(size=9)) + geom_histogram(fill= "lightblue")
p4  <- ggplot(data = data, aes(x = citric.acid) ) + theme(axis.text=element_text(size=7)) + geom_histogram(fill= "lightblue")
p5  <- ggplot(data = data, aes(x = residual.sugar) ) + geom_histogram(fill= "lightblue")
p6  <- ggplot(data = data, aes(x = chlorides) ) + theme(axis.text=element_text(size=11)) + geom_histogram(fill= "lightblue")
p7  <- ggplot(data = data, aes(x = free.sulfur.dioxide) ) + theme(axis.text=element_text(size=9)) + geom_histogram(fill= "lightblue")
p9  <- ggplot(data = data, aes(x = density) ) + theme(axis.text=element_text(size=7.5)) + geom_histogram(fill= "lightblue")
p10 <- ggplot(data = data, aes(x = pH) ) + geom_histogram(fill= "lightblue")
p11 <- ggplot(data = data, aes(x = sulphates) ) + theme(axis.text=element_text(size=9)) + geom_histogram(fill= "lightblue")
p12 <- ggplot(data = data, aes(x = alcohol) ) + geom_histogram(fill= "lightblue")

plot_grid(p1,p3,p4,p5,p6,p7,p9,p10,p11,p12,ncol = 4,nrow = 3)
```

We can see that free.sulfur.dioxide and alcohol have an obvious rightly skewed distribution. residual.sugar, cholorides, and sulphates also have a slightly rightward skewedness. citric.acid at first appears to have a bimodal distribution, but this is because there are some wines with zero citric acid, so we see a spike at 0 in the histogram. Based on the data definition, we know it is possible for wines to have citric acid of 0. ***** The distribution of citric acid is overall fairly symmetric. ***** All other variables: quality, volatile.acidity, density, and pH are unimodal and fairly symmetric.

******sort quality********

```{r}
# summary statistics of each variable
summary(data)
```

From the previous histogram, we can see that quality has a fairly normal distribution. The summary statistic also shows that quality rating of 5 has the most number of observations (it is also the middle rating on the scale of 0-10). So quality rating of 5 is the most appropriate **reference level** for the model.

```{r}
# makes quality==5 the reference level
data <- data %>% mutate(quality = relevel(quality, ref=5))
```

```{r}
# distribution of citric acid
ggplot(aes(x=citric.acid), data=data) + 
  geom_histogram(fill="steelblue2", color="black") + 
  ggtitle("Distribution of Citric Acid") + 
  theme(plot.title=element_text(color="black", size=14, face="bold.italic", hjust=0.5))
```

```{r}
# add mean-centered numerical variables besides citric.acid
data <- data %>% 
  mutate(volatile.acidityCent = volatile.acidity-mean(volatile.acidity), 
         residual.sugarCent = residual.sugar-mean(residual.sugar), 
         chloridesCent = chlorides-mean(chlorides), 
         free.sulfur.dioxideCent = free.sulfur.dioxide-mean(free.sulfur.dioxide), 
         sulphatesCent = sulphates-mean(sulphates), 
         densityCent = density-mean(density), pHCent = pH-mean(pH),   
         alcoholCent = alcohol-mean(alcohol))
```

# Regression Analysis

```{r}
lm(quality ~ volatile.acidityCent + residual.sugarCent + citric.acid + chloridesCent + free.sulfur.dioxideCent + sulphatesCent + densityCent + pHCent alcoholCent, data=data)
```
